<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cloudflare Domain Checker</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; }
        input, button { margin: 10px; padding: 10px; font-size: 16px; }
        ul { text-align: left; max-width: 600px; margin: auto; }
        .cloudflare { color: green; }
        .not-cloudflare { color: red; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>بررسی دامنه‌های Cloudflare</h1>
    <input type="number" id="count" placeholder="تعداد دامنه‌هایی که می‌خواهید تست کنید">
    <button onclick="startCheck()">بررسی دامنه‌ها</button>
    <ul id="resultList"></ul>
    <p id="errorMsg" class="error" style="display: none;"></p>

    <script>
        const cloudflareIPs = ["173.245.48", "103.21.244", "198.41.128", "104.16", "104.24"];

        async function checkCloudflare(domain) {
            try {
                const response = await fetch(`https://cloudflare-dns.com/dns-query?name=${domain}&type=A`, {
                    method: 'GET',
                    headers: { 'Accept': 'application/dns-json' }
                });
                const data = await response.json();
                if (data.Answer) {
                    return data.Answer.some(answer => cloudflareIPs.some(cf => answer.data.startsWith(cf)));
                }
            } catch (e) {
                console.error(`خطا در بررسی دامنه ${domain}: ${e}`);
                return false;
            }
            return false;
        }

        function getRandomDomains(count) {
            // اینجا دامنه‌های تصادفی ایجاد می‌کنیم
            const domains = ["example.com", "cloudflare.com", "example.net", "google.com", "github.com"];
            const randomDomains = [];
            for (let i = 0; i < count; i++) {
                randomDomains.push(domains[i % domains.length]);
            }
            return randomDomains;
        }

        async function startCheck() {
            const count = parseInt(document.getElementById('count').value);
            const resultList = document.getElementById('resultList');
            const errorMsg = document.getElementById('errorMsg');
            resultList.innerHTML = "در حال بررسی دامنه‌ها...";
            errorMsg.style.display = 'none';

            try {
                if (isNaN(count) || count <= 0) {
                    throw new Error("لطفاً تعداد معتبری وارد کنید.");
                }

                const domains = getRandomDomains(count); // دریافت دامنه‌های تصادفی
                resultList.innerHTML = "";

                for (let domain of domains) {
                    const isCloudflare = await checkCloudflare(domain);
                    const listItem = document.createElement('li');
                    listItem.textContent = domain;
                    listItem.classList.add(isCloudflare ? 'cloudflare' : 'not-cloudflare');
                    resultList.appendChild(listItem);
                }
            } catch (e) {
                errorMsg.textContent = e.message;
                errorMsg.style.display = 'block';
            }
        }
    </script>
</body>
</html>
